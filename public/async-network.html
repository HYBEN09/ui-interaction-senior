<!DOCTYPE html>
<html lang="ko-KR">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>비동기 통신 테스트</title>
</head>
<body>
  
  <button type="button">call async network</button>

  <ul class="print">

  </ul>

  <script>
    const button  = document.querySelector('button');
    const print  = document.querySelector('.print');

    const endpoint = 'https://jsonplaceholder.typicode.com/todo';

    button.addEventListener('click', () => {
      
      fetch(endpoint)
        .then(response => response.json())
        .then(json => {
          json.forEach(item => {
            print.innerHTML += `<li>${item.title}</li>`;
          })
        })
        .catch(error => {
          console.error(error.message)
          print.innerHTML += `<li style="color: red; font-weight: bold;">${error.message}</li>`;
        });
    });
  </script>

  <script>
    (() => {
      const button  = document.querySelector('button');
    const print  = document.querySelector('.print');

    const endpoint = 'https://jsonplaceholder.typicode.com/todos';

    button.addEventListener('click', () => {
      // XMLHttpRequest
      const xhr = new XMLHttpRequest();
      xhr.open('GET', endpoint);
      xhr.onreadystatechange = (e) => {
        const { target } = e;
        if (target.readyState === 4 && target.status === 200) {
          const data = JSON.parse(target.response);
          data.forEach(item => {
            print.innerHTML += `<li>${item.title}</li>`;
          })
        }
      }
      xhr.send(null);
    })
    });
  </script>
</body>
</html>